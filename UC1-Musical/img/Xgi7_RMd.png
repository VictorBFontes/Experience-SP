<script>
      onmessage = (event) => {
        if (event.source === window.parent.parent.parent && event.origin === "https://www.figma.com") {
          document.write("<script>" + "\n document.close();\n document.addEventListener('keydown', (e) => {\n   if (e.keyCode === 80 /* P */ && !e.shiftKey && e.altKey && e.ctrlKey && !e.metaKey) {\n     // Handle the plugin re-run shortcut\n     window.parent.postMessage('$INTERNAL_DO_NOT_USE$RERUN_PLUGIN$', '*')\n     e.stopPropagation()\n     e.stopImmediatePropagation()\n   } else if (false) {\n     // Handle Select All, Undo and Redo in the desktop app\n     if (e.keyCode === 65 /* A */ && e.ctrlKey) {\n       document.execCommand('selectAll')\n     } else if (e.keyCode === 90 /* Z */ && e.ctrlKey) {\n       if (e.shiftKey) {\n         document.execCommand('redo')\n       } else {\n         document.execCommand('undo')\n       }\n     }\n   }\n }, true)\n\n function renderCssVariables(vars) {\n   return Object.entries(vars)\n     .map((entry) => entry.join(': '))\n     .join('; ') + ';'\n }\n\n window.addEventListener('message', function(event) {\n   if (\n     event.source === window.parent.parent.parent &&\n     event.data &&\n     typeof event.data === 'object' &&\n     'figmaMessage' in event.data\n   ) {\n     event.stopImmediatePropagation()\n\n     const figmaMessage = event.data.figmaMessage\n\n     if (figmaMessage.type === 'THEME') {\n       const figmaStyle = document.getElementById('figma-style')\n       figmaStyle.textContent = ':root { ' + renderCssVariables(figmaMessage.payload.variables) + ' }'\n\n       const classesToRemove = []\n\n       document.documentElement.classList.forEach((value) => {\n         if (value.startsWith('figma-')) {\n           classesToRemove.push(value)\n         }\n       })\n\n       for (const className of classesToRemove) {\n         document.documentElement.classList.remove(className)\n       }\n\n       if (figmaMessage.payload.name && figmaMessage.payload.name !== 'legacy') {\n         document.documentElement.classList.add('figma-' + figmaMessage.payload.name)\n       }\n     }\n   }\n }, true)\n " + "" + "" + "</" + "script>" + event.data)
        }
      }

  </script>